## Shell Sort

### Concept

**Shell sort** is a variation of the Insertion sort alogrithm. In Insertion sort, we only move one position ahead after each swap or comparision, however in Shell sort, we may move more than position after each swap and comparision.


### How to sort elements in an array using Shell sort ?

Steps:
- We start with gap of n // 2 between the indices of elements being compared, where n is the number of elements in the array.
- We start by comparing the first element and element at (n // 2)th position.
- If the element at (n // 2)th is smaller than the first element, we swap them, otherwise we leave them.
- We, then, compare the second element and (n // 2 + 1)th place.
- We do this till we reach the end of the array on the right side.
- We then do the same comparisions from right to left.
- We then reduce the gap by 2, and start again.
- This goes on till the gap is less than 1.


Consider an unsorted array :
> 5 2 4 6 1
- Gap is 5 // 2 = 2.
- Element at 0th position (5) is compared with 2nd position (4).
- 2nd element < 0th element, hence we swap.

> 4 2 5 6 1
- Element at 1st position (2) is compared with 3rd position (6).
- 3rd element > 1st element, hence we move ahead.

> 4 2 5 6 1
- Element at 2nd position (5) is compared with 4th position (1).
- 4th element < 2nd element, hence we swap.

> 4 2 1 6 5
- We reach the end of the array, so now we do the same comparisions from right side to left.
- We swap elements which are out of order.
- We compare 4th element and 2nd element, they are in order, so we move ahead.

> 4 2 1 6 5
- We compare 3rd element and 1st element, they are in order, so we move ahead.

> 4 2 1 6 5
- We compare 2nd element and 0th element, they are out of order, so we swap.
> 1 2 4 6 5

> 1 2 4 6 5
- Gap is now 2 // 2 = 1
- We start again from first element.
- Element at 0th position (1) is compared with 1st position (2).
- 0th element < 1st element, hence we move ahead.

> 1 2 4 6 5
- Element at 1st position (2) is compared with 2nd position (4).
- 1st element < 2nd element, hence we move ahead..

> 1 2 4 6 5
- Element at 2nd position (4) is compared with 3rd position (6).
- 2nd element < 3rd element, hence we move ahead..

> 1 2 4 6 5
- Element at 3rd position (6) is compared with 4th position (5).
- 3rd element > 4th element, hence we swap.

> 1 2 4 5 6
- Array is sorted.

### Pseudo code for shell sort

Based on the above steps we can give the pseudo code as :
```
function shell_sort(array) :
    gap = length(array) // 2

    WHILE gap > 0
        i = 0
        j = gap

        # Comparing from left to right
        WHILE j < length(array)
            IF array[i] > array[j]
                swap(array[i], array[j])

                j = j + 1
                i = i + 1

        # Comparing from right to left
        k = i - 1
        WHILE k - gap > -1
            IF array[k] < array[k - gap]:
                arr[k], arr[k - gap] = arr[k - gap], arr[k]
            k = k - 1

        # Reducing the gap
        gap = gap // 2
```

In the shell_sort() function
- We iterate through the input array, comparing elements with the gap in between, and putting elements in order, till we reach the end of the array. 
- Then we iterate through the array from right to left, and put the element in order.
- We reduce the gap by 2, and start the whole process again.
- We do this till the gap reaches 0, and at the end, we will have a sorted array.

### Code for insertion sort

Let's see how to implement the given pseudo code in Python.
```python
def shell(arr):
    gap = len(arr) // 2

    while gap > 0:
        i = 0  # Index for the left element
        j = gap  # Index for the right element

        # Comparing from left to right
        while j < len(arr):
            if arr[i] > arr[j]:
                arr[i], arr[j] = arr[j], arr[i]
            
            i += 1
            j += 1
        
        # Comparing from right to left
        k = i - 1
        while k - gap > -1:
            if arr[k] < arr[k - gap]:
                arr[k], arr[k - gap] = arr[k - gap], arr[k]
            k -= 1

        # Reducing the gap by 2
        gap = gap // 2
```

### Analysis of Shell Sort Algorithm

**Time Complexity**
**Worst Case - O(n^2)**
**Best Case - O(n log n)**
**Average Case - O(n log n)**

**Space Complexity**
The algorithm uses constant space thus space complexity of algorithm will be **O(1)**

### Properties of Shell sort algorithm

- It is **not a stable** algorithm.
- It is an **adaptive** algorithm.
- It is an **internal** algorithm.
- It is more effecient than regular insertion sort.

**References**
- https://www.geeksforgeeks.org/shellsort/

